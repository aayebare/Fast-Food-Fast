<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width">
    <title>Sign Up</title>
    <link rel="stylesheet" type="text/css" href="./css/style.css">
</head>

<body>
    <div class="container">
        <div class="content-section">
            <p><a href="signup-admin.html">Signup as administrator?</a></p>
            <p><a href="user-login.html">Already have an account? Login</a></p>
        </div>
        <form id="addUser">
            <h1>Sign Up</h1>
            <p>Please fill this form to create an account</p>
            <hr>
            <label for="name"><b>Username</b></label>
            <input type="text" id="username" placeholder="Enter Username">
            <div id="name_error"> </div>
            <label for="email"><b>Email</b></label>
            <input type="text" id="email" placeholder="Enter Email">
            <label for="password"><b>Password</b></label>
            <input type="password" id="password" placeholder="Enter Password">
            <label for="confirm-password"><b>Confirm Password</b></label>
            <input type="password" id="confirm-password" placeholder="Confirm Password">
            <button type="submit" class="button-1" id="button">signup</button>
        </form>
    </div>
    <script>
        document.getElementById('addUser').addEventListener("submit", addUser);
    
        function addUser(e) {
            e.preventDefault();
            let user_name = document.getElementById('username').value;
            let email = document.getElementById('email').value;
            let password = document.getElementById('password').value;
            let confirm_password = document.getElementById('confirm-password').value;
            let is_admin = false
    
            fetch('http://127.0.0.1:5000/api/v1/auth/signup', {
                    method: 'POST',
                    headers: {
                        'Accept': 'application/json, text/plain, */*',
                        'Content-type': 'application/json'
                    },
                    body: JSON.stringify({
                        username: user_name,
                        email: email,
                        password: password,
                        confirm_password: confirm_password,
                        is_admin: is_admin
                    })
    
                })
                .then(response => {
                    if (response.status == 201) {
                        window.location = 'user-login.html'
                        alert('You have successfully registered, please login')
                    } else {
                        alert('Please fill all the fields')
                    }
                })
    
            .catch((err) => console.log(err))
        }
</script>
</body>

</html>
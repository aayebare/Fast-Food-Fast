<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width">
    <title>fast food item</title>
    <link rel="stylesheet" type="text/css" href="./css/style.css">
</head>

<body>
    <a id="logout" href="user-login.html"><h4>Logout and Exit</h4></a> 
    <div class="container">
        <form id="addItem">
            <a href="admin-edit-items.html">
                <h1>Fast Food Item</h1>
            </a>
            <p>Add or Edit Item</p>
            <hr>
            <label for="title"><b>Fast Food </b></label>
            <input type="text" id="title" placeholder="Enter Fast Food">
            <label for="description"><b>Description</b></label>
            <input type="text" id="detail" placeholder="Add Description">
            <label for="price"><b>Price</b></label>
            <input type="text" id="price" placeholder="Add a Unit Price in UGX">
            <button type="submit" class="button-1">Save</button>
        </form>

    </div>
    <script>
        document.getElementById('addItem').addEventListener( "submit", addItem);
        document.getElementById('logout').addEventListener('click', logout);
        var token = sessionStorage.getItem('Token');
        function logout(){
            alert('Logout and Exit?')
            sessionStorage.removeItem('Token');
           
        }
        function addItem(e){
            e.preventDefault();
           let title = document.getElementById('title').value;
           let detail = document.getElementById('detail').value;
           let price = document.getElementById('price').value;
           fetch('http://127.0.0.1:5000/api/v1/menu',{
               method:'POST',
               headers:{'Accept':'application/json, text/plain, */*',
               'Content-type':'application/json',
               'Authorization': 'Bearer '+ token,
               credentials:'include'
               },
               body:JSON.stringify({content:title,detail:detail,price:price})
           })
           .then((response)=>response.json())
           .then((data)=>{
               console.log(data)
               if(data.success=='Item successfully posted'){
                   alert('Item successfully added to menu, continue')
                   window.location='admin-item.html'
               }
               else if(data.message=='Admin previledges required to perform this function'){
                   alert('Admin previledges required to perform this function')
               }
               
               else if(data.message=='Please add content or detail or price fields'){
                   alert('please fill all the fields to add food item')
               }
               else if(data.message=='Please add value in the content field'){
                   alert('Please add value in the content field')
               }
               else if(data.message=='Please add a unit price'){
                   alert('Please add a unit price to continue')
               }
           })
           .catch((err) => console.log(err))
        }

   </script>  

</body>

</html>